#! /bin/sh
# File          :  iptack
# Created       :  Sat 22 Aug 2015 22:51:54
# Last Modified :  Sat 31 Oct 2015 21:00:51
# Maintainer    :  sharlatan, <sharlatanus@gmail.com>
#
# iptack - show ips atacking you
#
. ~/.local/bin/var-lib
. ~/.local/bin/fun-lib

if_sudo

# list of attackers IPs

IP_ALL=$(lastb | awk -F" " '{print $3}' | sort -u)
IP_SORTED=$(sort ${IP_ALL})

for ip in ${IP_SORTED}; do
    #country_code=$(geoiplookup $ip | grep -Po -m1 '(?<=\s)[A-Z]{2}(?=[\W])')
    printf "$ip $(grep -c ${IP_ALL})"
done
