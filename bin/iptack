#! /bin/sh
# File          :  iptack
# Created       :  Sat 22 Aug 2015 22:51:54
# Last Modified :  Sat 31 Oct 2015 20:19:51
# Maintainer    :  sharlatan, <sharlatanus@gmail.com>
#
# iptack - show ips atacking you
#
. ~/.local/bin/var-lib
. ~/.local/bin/fun-lib

if_sudo

# list of attackers IPs

IP_SORTED=$(lastb | awk -F" " '{print $3}' | sort | uniq -c | sort -nr)

for ip in ${IP_SORTED}; do
    # ip_country=$(geoiplookup $ip | grep -Po -m1 '(?<=\s)[A-Z]{2}(?=[\,|\s])')
    printf "$ip\n"
done
